<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Store</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #333;
            color: white;
            padding: 1em;
            text-align: center;
        }
        main {
            padding: 1em;
        }
        .category {
            margin: 1em 0;
        }
        .product {
            display: flex;
            align-items: center;
            margin: 1em 0;
        }
        .product img {
            max-width: 100px;
            margin-right: 1em;
        }
        .cart {
            position: fixed;
            top: 0;
            right: 0;
            background-color: white;
            border: 1px solid #ccc;
            padding: 1em;
            max-width: 300px;
            height: 100%;
            overflow-y: auto;
        }
        .cart-item {
            margin-bottom: 1em;
        }
        .share-button {
            background-color: #25D366;
            color: white;
            border: none;
            padding: 0.5em 1em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <h1>Online Store</h1>
    </header>
    <main>
        <div id="categories"></div>
    </main>
    <div class="cart" id="cart">
        <h2>Cart</h2>
        <div id="cart-items"></div>
        <button class="share-button" id="share-button">Share on WhatsApp</button>
    </div>

    <script>
        const categoriesContainer = document.getElementById('categories');
        const cartItemsContainer = document.getElementById('cart-items');
        const shareButton = document.getElementById('share-button');

        let products = [];
        let cart = [];

        // Load products from test.txt
        fetch('test.txt')
            .then(response => response.text())
            .then(data => {
                const lines = data.split('\n');
                lines.forEach(line => {
                    const [category, name, price, image] = line.split('/');
                    products.push({ category, name, price, image });
                });
                renderCategories();
            });

        function renderCategories() {
            const categories = [...new Set(products.map(p => p.category))];
            categories.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                const categoryTitle = document.createElement('h2');
                categoryTitle.textContent = category;
                categoryDiv.appendChild(categoryTitle);

                const categoryProducts = products.filter(p => p.category === category);
                categoryProducts.forEach(product => {
                    const productDiv = document.createElement('div');
                    productDiv.className = 'product';

                    const productImage = document.createElement('img');
                    productImage.src = product.image;
                    productDiv.appendChild(productImage);

                    const productDetails = document.createElement('div');
                    productDetails.innerHTML = `<strong>${product.name}</strong><br>Price: ${product.price}`;
                    productDiv.appendChild(productDetails);

                    const addToCartButton = document.createElement('button');
                    addToCartButton.textContent = 'Add to Cart';
                    addToCartButton.onclick = () => addToCart(product);
                    productDiv.appendChild(addToCartButton);

                    categoryDiv.appendChild(productDiv);
                });

                categoriesContainer.appendChild(categoryDiv);
            });
        }

        function addToCart(product) {
            const existingProduct = cart.find(item => item.name === product.name);
            if (existingProduct) {
                existingProduct.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            renderCart();
        }

        function renderCart() {
            cartItemsContainer.innerHTML = '';
            let total = 0;
            cart.forEach(item => {
                const cartItemDiv = document.createElement('div');
                cartItemDiv.className = 'cart-item';
                cartItemDiv.innerHTML = `<strong>${item.name}</strong><br>Price: ${item.price}<br>Quantity: ${item.quantity}`;
                total += item.price * item.quantity;
                cartItemsContainer.appendChild(cartItemDiv);
            });

            const totalDiv = document.createElement('div');
            totalDiv.innerHTML = `<strong>Total: ${total}</strong>`;
            cartItemsContainer.appendChild(totalDiv);
        }

        shareButton.onclick = () => {
            let text = 'Cart Summary:\n';
            let total = 0;
            cart.forEach(item => {
                text += `${item.name} - ${item.price} x ${item.quantity}\n`;
                total += item.price * item.quantity;
            });
            text += `Total: ${total}`;
            const whatsappURL = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(whatsappURL, '_blank');
        };
    </script>
</body>
</html>
