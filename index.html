<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Store</title>
    <style>
      body {
          font-family: Arial, sans-serif;
          margin: 0;
          padding: 0;
          background-color: #f4f4f4;
      }
  
      header {
          background-color: #333;
          color: white;
          padding: 1.5em;
          text-align: center;
      }
  
      h2 {
          font-size: 1.8em;
          margin-bottom: 1em;
          color: #333;
          text-transform: uppercase;
          letter-spacing: 1px;
          font-weight: bold;
      }
  
      main {
          display: flex;
          flex-wrap: wrap;
          justify-content: space-around;
          padding: 2em;
      }
  
      .category {
          margin: 2em 0;
      }
  
      .product {
          background-color: white;
          width: 250px;
          margin: 1em;
          padding: 1em;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          text-align: center;
          transition: transform 0.3s ease;
      }
  
      .product:hover {
          transform: translateY(-10px);
      }
  
      .product img {
          max-width: 100%;
          border-radius: 8px;
          margin-bottom: 1em;
      }
  
      .product-name {
          font-size: 1.2em;
          color: #333;
          margin-bottom: 0.5em;
          font-weight: bold;
      }
  
      .product-price {
          font-size: 1.1em;
          color: #e74c3c;
          margin-bottom: 1em;
      }
  
      .add-to-cart {
          background-color: #3498db;
          color: white;
          border: none;
          padding: 0.7em 1.5em;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.3s ease;
      }
  
      .add-to-cart:hover {
          background-color: #2980b9;
      }
  
      .cart {
          position: fixed;
          top: 0;
          right: 0;
          background-color: white;
          border: 1px solid #ccc;
          padding: 1em;
          max-width: 300px;
          height: 100%;
          overflow-y: auto;
          box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.1);
      }
  
      .cart-item {
          margin-bottom: 1em;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
  
      .cart-item button {
          background-color: red;
          color: white;
          border: none;
          cursor: pointer;
          padding: 0.2em 0.5em;
      }
  
      .share-button {
          background-color: #25D366;
          color: white;
          border: none;
          padding: 0.5em 1em;
          cursor: pointer;
      }
  
      .popup {
          display: none;
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background-color: white;
          border: 1px solid #ccc;
          padding: 1em;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          border-radius: 8px;
      }
  
      .popup input {
          margin-bottom: 1em;
          width: 100%;
          padding: 0.5em;
      }
  
      .popup button {
          margin-right: 0.5em;
      }
  </style>
  </head>
<body>
    <header>
        <h1>Online Store</h1>
    </header>
    <main>
        <div id="categories"></div>
    </main>
    <div class="cart" id="cart">
        <h2>Cart</h2>
        <div id="cart-items"></div>
        <button class="share-button" id="checkout-button">Checkout</button>
    </div>
    <div class="popup" id="popup">
        <h2>Customer Details</h2>
        <input type="text" id="customer-name" placeholder="Enter your name">
        <input type="text" id="customer-phone" placeholder="Enter your phone number">
        <button id="confirm-button">Confirm</button>
        <button id="cancel-button">Cancel</button>
    </div>

    <script>
const categoriesContainer = document.getElementById('categories');
const cartItemsContainer = document.getElementById('cart-items');
const checkoutButton = document.getElementById('checkout-button');
const popup = document.getElementById('popup');
const confirmButton = document.getElementById('confirm-button');
const cancelButton = document.getElementById('cancel-button');

const customerNameInput = document.getElementById('customer-name');
const customerPhoneInput = document.getElementById('customer-phone');

let products = [];
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// Load products from test.txt
fetch('test.txt')
    .then(response => response.text())
    .then(data => {
        const lines = data.split('\n');
        lines.forEach(line => {
            // Splitting the line into components and assuming format: category/name/price/image_url
            const parts = line.split('/');
            if (parts.length >= 4) {
                // Handle image URL with query parameters (e.g., "?x-oss-process=image...")
                const imageUrl = parts.slice(3).join('/').trim(); // Combine all parts after the 3rd element
                products.push({
                    category: parts[0].trim(),
                    name: parts[1].trim(),
                    price: parseFloat(parts[2].trim()),
                    image: imageUrl
                });
            }
        });
        renderCategories();
        renderCart();
    })
    .catch(error => console.error('Error loading products:', error));

function renderCategories() {
    categoriesContainer.innerHTML = ''; // Clear previous categories
    const categories = [...new Set(products.map(p => p.category))];
    categories.forEach(category => {
        const categoryDiv = document.createElement('div');
        categoryDiv.className = 'category';

        const categoryTitle = document.createElement('h2');
        categoryTitle.textContent = category;
        categoryDiv.appendChild(categoryTitle);

        const categoryProducts = products.filter(p => p.category === category);
        categoryProducts.forEach(product => {
            const productDiv = document.createElement('div');
            productDiv.className = 'product';

            // Creating and adding image element with error handling
            const productImage = document.createElement('img');
            productImage.src = product.image;
            productImage.alt = product.name; // Adding alt text for better accessibility

            // Error handling for image load failure
            productImage.onerror = () => {
                productImage.src = 'default-image.jpg'; // Use a default image if the image URL is invalid
            };

            productDiv.appendChild(productImage);

            const productDetails = document.createElement('div');
            productDetails.innerHTML = `<strong>${product.name}</strong><br>Price: ${product.price.toFixed(2)} $`;
            productDiv.appendChild(productDetails);

            const addToCartButton = document.createElement('button');
            addToCartButton.textContent = 'Add to Cart';
            addToCartButton.onclick = () => addToCart(product);
            productDiv.appendChild(addToCartButton);

            categoryDiv.appendChild(productDiv);
        });

        categoriesContainer.appendChild(categoryDiv);
    });
}

function addToCart(product) {
    const existingProduct = cart.find(item => item.name === product.name);
    if (existingProduct) {
        existingProduct.quantity++;
    } else {
        cart.push({ ...product, quantity: 1 });
    }
    saveCart();
    renderCart();
}

function removeFromCart(productName) {
    cart = cart.filter(item => item.name !== productName);
    saveCart();
    renderCart();
}

function saveCart() {
    localStorage.setItem('cart', JSON.stringify(cart));
}

function renderCart() {
    cartItemsContainer.innerHTML = ''; // Clear previous cart items
    let total = 0;

    cart.forEach(item => {
        const cartItemDiv = document.createElement('div');
        cartItemDiv.className = 'cart-item';

        const itemDetails = document.createElement('div');
        itemDetails.innerHTML = `
            <strong>${item.name}</strong><br>
            Price: ${item.price.toFixed(2)} $<br>
            Quantity: ${item.quantity}
        `;
        cartItemDiv.appendChild(itemDetails);

        const removeButton = document.createElement('button');
        removeButton.textContent = 'X';
        removeButton.onclick = () => removeFromCart(item.name);
        cartItemDiv.appendChild(removeButton);

        total += item.price * item.quantity;
        cartItemsContainer.appendChild(cartItemDiv);
    });

    const totalDiv = document.createElement('div');
    totalDiv.className = 'cart-total';
    totalDiv.innerHTML = `<strong>Total: ${total.toFixed(2)} $</strong>`;
    cartItemsContainer.appendChild(totalDiv);
}
      
      function saveCart() {
          localStorage.setItem('cart', JSON.stringify(cart));
      }
      
      checkoutButton.onclick = () => {
          popup.style.display = 'block';
      };
      
      confirmButton.onclick = () => {
          const customerName = customerNameInput.value;
          const customerPhone = customerPhoneInput.value;
      
          if (!customerName || !customerPhone) {
              alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£Ø³Ù… Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ.');
              return;
          }
// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨ØªÙ†Ø³ÙŠÙ‚ "ÙŠÙˆÙ…/Ø´Ù‡Ø±/Ø³Ù†Ø© Ø³Ø§Ø¹Ø©:Ø¯Ù‚ÙŠÙ‚Ø©Ù… Ø§Ù„ÙŠÙˆÙ…"
function formatDateTime() {
    const now = new Date();
    const day = now.getDate().toString().padStart(2, '0');
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const year = now.getFullYear();
    let hours = now.getHours();
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const ampm = hours >= 12 ? 'Ù…' : 'Øµ';
    hours = hours % 12;
    hours = hours ? hours : 12; // Ø§Ù„Ø³Ø§Ø¹Ø© 0 ØªØµØ¨Ø­ 12
    const dayOfWeek = ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"][now.getDay()];
    return `${day}/${month}/${year} ${hours}:${minutes}${ampm} ${dayOfWeek}`;
}

// Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ø«Ø§Ø¨Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§ ####)
const invoiceNumber = "####";

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ù„Ù‰ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
let text = `â­ï¸ Shehadeh Centre â­ï¸\n`;
text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
text += `ðŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${formatDateTime()}\n`;
text += `ðŸ“„ Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: ${invoiceNumber}\n`;
text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
text += `ðŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customerName}\n`;
text += `â˜Žï¸ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${customerPhone}\n`;
text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
text += `ðŸ›’ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:\n`;

let total = 0;
cart.forEach(item => {
    text += `\t${item.name}: ${item.quantity}x${item.price.toFixed(2)}\n`;
    text += `â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€\n`;
    total += item.price * item.quantity;
});

text += `ðŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toFixed(2)}\n`;
text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
text += `Ø´ÙƒØ±Ù‹Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø±ÙƒÙ… Ø®Ø¯Ù…Ø§ØªÙ†Ø§! ðŸ™`;

// Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
const whatsappURL = `https://wa.me/972566888825?text=${encodeURIComponent(text)}`;
window.open(whatsappURL, '_blank');

// Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù„Ø© ÙˆØ­ÙØ¸Ù‡Ø§
cart = [];
saveCart();
renderCart();

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
popup.style.display = 'none';

      };
      
      cancelButton.onclick = () => {
          popup.style.display = 'none';
      };
      </script>
      </body>
</html>
